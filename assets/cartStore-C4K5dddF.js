import{j as y,l as a,k}from"./index-CMEQwe3J.js";import{h as l,u as E,E as P}from"./base-BYK0webe.js";const S=async({skuId:c,count:r})=>await l({url:"/member/cart",method:"POST",data:{skuId:c,count:r}}),A=async()=>await l({url:"/member/cart"}),L=async c=>await l({url:"/member/cart",method:"DELETE",data:{ids:c}}),T=y("cart",()=>{const c=E(),r=a(()=>c.userInfo.token),s=k([]),d=async e=>{const{skuId:t,count:n}=e;if(r.value)await S({skuId:t,count:n}),u();else{const o=s.value.find(w=>w.skuId===e.skuId);o?o.count+=e.count:s.value.push(e)}},i=async e=>{if(r.value)await L([e]),u();else{const t=s.value.findIndex(n=>e===n.skuId);s.value.splice(t,1),P.success("已刪除一筆商品")}},u=async()=>{const e=await A();s.value=e.result},m=({skuId:e,selected:t})=>{const n=s.value.find(o=>o.skuId===e);n.selected=t},v=a(()=>s.value.reduce((e,t)=>e+t.count,0)),f=a(()=>s.value.reduce((e,t)=>e+t.count*t.price,0)),I=e=>{s.value.forEach(t=>t.selected=e)},p=a(()=>s.value.every(e=>e.selected)),C=a(()=>s.value.filter(e=>e.selected).reduce((e,t)=>e+t.count,0)),h=a(()=>s.value.filter(e=>e.selected).reduce((e,t)=>e+t.count*t.price,0));return{cartList:s,allCount:v,allPrice:f,addCart:d,delCart:i,handelSingleCheck:m,allCheck:I,isAllCheck:p,selectItemCount:C,selectItemTotalPrice:h}},{persist:!0});export{T as u};
