import{k as Ee,D as Le,o as j,j as re,q as G,_ as we,E as H,z as De,A as Ve,F as Me,G as He,B as fe,p as Ke,H as ve,w as Ue,C as je}from"./base-BB0VGiTW.js";import{E as Ge,a as qe}from"./breadcrumb-item-Cuvgnemc.js";import{a as We,b as pe}from"./category-Dkn0vtuQ.js";import{a6 as Ye,g as L,v as ie,p as h,j as R,J as M,o as k,c as I,n as Ne,f as F,A as Je,l as q,h as U,k as ce,a7 as Xe,b as m,y as Qe,z as oe,K as Ze,a1 as et,a4 as tt,a5 as at,B as Se,O as st,I as Ce,i as nt,_ as ot,$ as lt,a as ee,w as V,t as te,F as me,d as _e,e as ae,G as ge}from"./index-C1ImVDH_.js";import{u as rt,t as he,G as it}from"./GoodsItem-Dg4uaIEm.js";import{a as $e,b as ct,c as ut}from"./index-B3TDH60y.js";import{E as K}from"./aria-BUADUvnR.js";import"./icon-UGr1kMCN.js";const ye=e=>{let t=0,a=e;for(;a;)t+=a.offsetTop,a=a.offsetParent;return t},dt=(e,t)=>Math.abs(ye(e)-ye(t)),A=e=>Ye(e);class bt extends Error{constructor(t){super(t),this.name="ElementPlusError"}}function W(e,t){throw new bt(`[${e}] ${t}`)}const ft=(e,t)=>{if(!Ee)return!1;const a={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(t)],c=Le(e,a);return["scroll","auto","overlay"].some(n=>c.includes(n))},vt=(e,t)=>{if(!Ee)return;let a=e;for(;a;){if([window,document,document.documentElement].includes(a))return window;if(ft(a,t))return a;a=a.parentNode}return a},Pe="update:modelValue",xe=e=>e,Y=Symbol("tabsRootContextKey"),pt=j({tabs:{type:re(Array),default:()=>xe([])}}),Be="ElTabBar",mt=L({name:Be}),_t=L({...mt,props:pt,setup(e,{expose:t}){const a=e,c=q(),n=ie(Y);n||W(Be,"<el-tabs><el-tab-bar /></el-tabs>");const s=G("tabs"),f=h(),v=h(),u=()=>{let r=0,y=0;const o=["top","bottom"].includes(n.props.tabPosition)?"width":"height",i=o==="width"?"x":"y",w=i==="x"?"left":"top";return a.tabs.every(l=>{var g,C;const N=(C=(g=c.parent)==null?void 0:g.refs)==null?void 0:C[`tab-${l.uid}`];if(!N)return!1;if(!l.active)return!0;r=N[`offset${A(w)}`],y=N[`client${A(o)}`];const T=window.getComputedStyle(N);return o==="width"&&(a.tabs.length>1&&(y-=Number.parseFloat(T.paddingLeft)+Number.parseFloat(T.paddingRight)),r+=Number.parseFloat(T.paddingLeft)),!1}),{[o]:`${y}px`,transform:`translate${A(i)}(${r}px)`}},b=()=>v.value=u();return R(()=>a.tabs,async()=>{await M(),b()},{immediate:!0}),$e(f,()=>b()),t({ref:f,update:b}),(r,y)=>(k(),I("div",{ref_key:"barRef",ref:f,class:Ne([F(s).e("active-bar"),F(s).is(F(n).props.tabPosition)]),style:Je(v.value)},null,6))}});var gt=we(_t,[["__file","tab-bar.vue"]]);const ht=j({panes:{type:re(Array),default:()=>xe([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),yt={tabClick:(e,t,a)=>a instanceof Event,tabRemove:(e,t)=>t instanceof Event},Te="ElTabNav",Tt=L({name:Te,props:ht,emits:yt,setup(e,{expose:t,emit:a}){const c=q(),n=ie(Y);n||W(Te,"<el-tabs><tab-nav /></el-tabs>");const s=G("tabs"),f=ct(),v=ut(),u=h(),b=h(),r=h(),y=h(),o=h(!1),i=h(0),w=h(!1),l=h(!0),g=U(()=>["top","bottom"].includes(n.props.tabPosition)?"width":"height"),C=U(()=>({transform:`translate${g.value==="width"?"X":"Y"}(-${i.value}px)`})),N=()=>{if(!u.value)return;const p=u.value[`offset${A(g.value)}`],_=i.value;if(!_)return;const d=_>p?_-p:0;i.value=d},T=()=>{if(!u.value||!b.value)return;const p=b.value[`offset${A(g.value)}`],_=u.value[`offset${A(g.value)}`],d=i.value;if(p-d<=_)return;const $=p-d>_*2?d+_:p-_;i.value=$},D=async()=>{const p=b.value;if(!o.value||!r.value||!u.value||!p)return;await M();const _=r.value.querySelector(".is-active");if(!_)return;const d=u.value,$=["top","bottom"].includes(n.props.tabPosition),P=_.getBoundingClientRect(),S=d.getBoundingClientRect(),O=$?p.offsetWidth-S.width:p.offsetHeight-S.height,x=i.value;let E=x;$?(P.left<S.left&&(E=x-(S.left-P.left)),P.right>S.right&&(E=x+P.right-S.right)):(P.top<S.top&&(E=x-(S.top-P.top)),P.bottom>S.bottom&&(E=x+(P.bottom-S.bottom))),E=Math.max(E,0),i.value=Math.min(E,O)},de=()=>{var p;if(!b.value||!u.value)return;e.stretch&&((p=y.value)==null||p.update());const _=b.value[`offset${A(g.value)}`],d=u.value[`offset${A(g.value)}`],$=i.value;d<_?(o.value=o.value||{},o.value.prev=$,o.value.next=$+d<_,_-$<d&&(i.value=_-d)):(o.value=!1,$>0&&(i.value=0))},Ae=p=>{const _=p.code,{up:d,down:$,left:P,right:S}=K;if(![d,$,P,S].includes(_))return;const O=Array.from(p.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)")),x=O.indexOf(p.target);let E;_===P||_===d?x===0?E=O.length-1:E=x-1:x<O.length-1?E=x+1:E=0,O[E].focus({preventScroll:!0}),O[E].click(),be()},be=()=>{l.value&&(w.value=!0)},J=()=>w.value=!1;return R(f,p=>{p==="hidden"?l.value=!1:p==="visible"&&setTimeout(()=>l.value=!0,50)}),R(v,p=>{p?setTimeout(()=>l.value=!0,50):l.value=!1}),$e(r,de),ce(()=>setTimeout(()=>D(),0)),Xe(()=>de()),t({scrollToActiveTab:D,removeFocus:J}),R(()=>e.panes,()=>c.update(),{flush:"post",deep:!0}),()=>{const p=o.value?[m("span",{class:[s.e("nav-prev"),s.is("disabled",!o.value.prev)],onClick:N},[m(H,null,{default:()=>[m(De,null,null)]})]),m("span",{class:[s.e("nav-next"),s.is("disabled",!o.value.next)],onClick:T},[m(H,null,{default:()=>[m(Ve,null,null)]})])]:null,_=e.panes.map((d,$)=>{var P,S,O,x;const E=d.uid,X=d.props.disabled,Q=(S=(P=d.props.name)!=null?P:d.index)!=null?S:`${$}`,Z=!X&&(d.isClosable||e.editable);d.index=`${$}`;const ze=Z?m(H,{class:"is-icon-close",onClick:z=>a("tabRemove",d,z)},{default:()=>[m(Me,null,null)]}):null,Ie=((x=(O=d.slots).label)==null?void 0:x.call(O))||d.props.label,Re=!X&&d.active?0:-1;return m("div",{ref:`tab-${E}`,class:[s.e("item"),s.is(n.props.tabPosition),s.is("active",d.active),s.is("disabled",X),s.is("closable",Z),s.is("focus",w.value)],id:`tab-${Q}`,key:`tab-${E}`,"aria-controls":`pane-${Q}`,role:"tab","aria-selected":d.active,tabindex:Re,onFocus:()=>be(),onBlur:()=>J(),onClick:z=>{J(),a("tabClick",d,Q,z)},onKeydown:z=>{Z&&(z.code===K.delete||z.code===K.backspace)&&a("tabRemove",d,z)}},[Ie,ze])});return m("div",{ref:r,class:[s.e("nav-wrap"),s.is("scrollable",!!o.value),s.is(n.props.tabPosition)]},[p,m("div",{class:s.e("nav-scroll"),ref:u},[m("div",{class:[s.e("nav"),s.is(n.props.tabPosition),s.is("stretch",e.stretch&&["top","bottom"].includes(n.props.tabPosition))],ref:b,style:C.value,role:"tablist",onKeydown:Ae},[e.type?null:m(gt,{ref:y,tabs:[...e.panes]},null),_])])])}}}),Et=j({type:{type:String,values:["card","border-card",""],default:""},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:re(Function),default:()=>!0},stretch:Boolean}),se=e=>Ze(e)||Ke(e),wt={[Pe]:e=>se(e),tabClick:(e,t)=>t instanceof Event,tabChange:e=>se(e),edit:(e,t)=>["remove","add"].includes(t),tabRemove:e=>se(e),tabAdd:()=>!0},Nt=L({name:"ElTabs",props:Et,emits:wt,setup(e,{emit:t,slots:a,expose:c}){var n;const s=G("tabs"),{children:f,addChild:v,removeChild:u}=rt(q(),"ElTabPane"),b=h(),r=h((n=e.modelValue)!=null?n:"0"),y=async(l,g=!1)=>{var C,N,T;if(!(r.value===l||fe(l)))try{await((C=e.beforeLeave)==null?void 0:C.call(e,l,r.value))!==!1&&(r.value=l,g&&(t(Pe,l),t("tabChange",l)),(T=(N=b.value)==null?void 0:N.removeFocus)==null||T.call(N))}catch{}},o=(l,g,C)=>{l.props.disabled||(y(g,!0),t("tabClick",l,C))},i=(l,g)=>{l.props.disabled||fe(l.props.name)||(g.stopPropagation(),t("edit",l.props.name,"remove"),t("tabRemove",l.props.name))},w=()=>{t("edit",void 0,"add"),t("tabAdd")};return R(()=>e.modelValue,l=>y(l)),R(r,async()=>{var l;await M(),(l=b.value)==null||l.scrollToActiveTab()}),Qe(Y,{props:e,currentName:r,registerPane:v,unregisterPane:u}),c({currentName:r}),()=>{const l=a["add-icon"],g=e.editable||e.addable?m("span",{class:s.e("new-tab"),tabindex:"0",onClick:w,onKeydown:T=>{T.code===K.enter&&w()}},[l?oe(a,"add-icon"):m(H,{class:s.is("icon-plus")},{default:()=>[m(He,null,null)]})]):null,C=m("div",{class:[s.e("header"),s.is(e.tabPosition)]},[g,m(Tt,{ref:b,currentName:r.value,editable:e.editable,type:e.type,panes:f.value,stretch:e.stretch,onTabClick:o,onTabRemove:i},null)]),N=m("div",{class:s.e("content")},[oe(a,"default")]);return m("div",{class:[s.b(),s.m(e.tabPosition),{[s.m("card")]:e.type==="card",[s.m("border-card")]:e.type==="border-card"}]},[...e.tabPosition!=="bottom"?[C,N]:[N,C]])}}}),St=j({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),Ct=["id","aria-hidden","aria-labelledby"],Oe="ElTabPane",$t=L({name:Oe}),Pt=L({...$t,props:St,setup(e){const t=e,a=q(),c=et(),n=ie(Y);n||W(Oe,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const s=G("tab-pane"),f=h(),v=U(()=>t.closable||n.props.closable),u=ve(()=>{var i;return n.currentName.value===((i=t.name)!=null?i:f.value)}),b=h(u.value),r=U(()=>{var i;return(i=t.name)!=null?i:f.value}),y=ve(()=>!t.lazy||b.value||u.value);R(u,i=>{i&&(b.value=!0)});const o=tt({uid:a.uid,slots:c,props:t,paneName:r,active:u,index:f,isClosable:v});return ce(()=>{n.registerPane(o)}),at(()=>{n.unregisterPane(o.uid)}),(i,w)=>F(y)?Se((k(),I("div",{key:0,id:`pane-${F(r)}`,class:Ne(F(s).b()),role:"tabpanel","aria-hidden":!F(u),"aria-labelledby":`tab-${F(r)}`},[oe(i.$slots,"default")],10,Ct)),[[st,F(u)]]):Ce("v-if",!0)}});var ke=we(Pt,[["__file","tab-pane.vue"]]);const xt=Ue(Nt,{TabPane:ke}),Bt=je(ke),B="ElInfiniteScroll",Ot=50,kt=200,Ft=0,At={delay:{type:Number,default:kt},distance:{type:Number,default:Ft},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},ue=(e,t)=>Object.entries(At).reduce((a,[c,n])=>{var s,f;const{type:v,default:u}=n,b=e.getAttribute(`infinite-scroll-${c}`);let r=(f=(s=t[b])!=null?s:b)!=null?f:u;return r=r==="false"?!1:r,r=v(r),a[c]=Number.isNaN(r)?u:r,a},{}),Fe=e=>{const{observer:t}=e[B];t&&(t.disconnect(),delete e[B].observer)},zt=(e,t)=>{const{container:a,containerEl:c,instance:n,observer:s,lastScrollTop:f}=e[B],{disabled:v,distance:u}=ue(e,n),{clientHeight:b,scrollHeight:r,scrollTop:y}=c,o=y-f;if(e[B].lastScrollTop=y,s||v||o<0)return;let i=!1;if(a===e)i=r-(b+y)<=u;else{const{clientTop:w,scrollHeight:l}=e,g=dt(e,c);i=y+b>=g+w+l-u}i&&t.call(n)};function ne(e,t){const{containerEl:a,instance:c}=e[B],{disabled:n}=ue(e,c);n||a.clientHeight===0||(a.scrollHeight<=a.clientHeight?t.call(c):Fe(e))}const It={async mounted(e,t){const{instance:a,value:c}=t;nt(c)||W(B,"'v-infinite-scroll' binding value must be a function"),await M();const{delay:n,immediate:s}=ue(e,a),f=vt(e,!0),v=f===window?document.documentElement:f,u=he(zt.bind(null,e,c),n);if(f){if(e[B]={instance:a,container:f,containerEl:v,delay:n,cb:c,onScroll:u,lastScrollTop:v.scrollTop},s){const b=new MutationObserver(he(ne.bind(null,e,c),Ot));e[B].observer=b,b.observe(e,{childList:!0,subtree:!0}),ne(e,c)}f.addEventListener("scroll",u)}},unmounted(e){if(!e[B])return;const{container:t,onScroll:a}=e[B];t==null||t.removeEventListener("scroll",a),Fe(e)},async updated(e){if(!e[B])await M();else{const{containerEl:t,cb:a,observer:c}=e[B];t.clientHeight&&c&&ne(e,a)}}},le=It;le.install=e=>{e.directive("InfiniteScroll",le)};const Rt=le,Lt={class:"container"},Dt={class:"bread-container"},Vt={class:"sub-container"},Mt={style:{"padding-left":"35px",color:"#999","font-size":"12px"}},Ht=["infinite-scroll-disabled"],Kt={key:0,class:"loading"},Ut=L({name:"subCategory"}),jt=Object.assign(Ut,{setup(e){const t=lt(),a=h([{label:"最新商品",name:"publishTime"},{label:"最高人氣",name:"orderNum"},{label:"最多評論",name:"evaluateNum"}]),c=h([]),n=h([]),s=h(!1),f=h(!1),v=h({categoryId:t.params.id,page:1,pageSize:20,sortField:"publishTime"}),u=async()=>{try{await We(t.params.id).then(o=>{o.msg==="操作成功"&&(c.value=o.result)})}catch(o){console.log("err ======",o)}},b=async()=>{const o=await pe(v.value);n.value=o.result.items},r=()=>{console.log("tabs切換了 =======",v.value),v.value.page=1,b()},y=async()=>{v.value.page++,s.value=!0;const o=await pe(v.value);o&&(n.value=[...n.value,...o.result.items]),console.log("page ~~~",v.value.page),o.result.items.length||(s.value=!1,f.value=!0)};return ce(()=>{u(),b()}),(o,i)=>{const w=qe,l=Ge,g=Bt,C=xt,N=Rt;return k(),I("div",Lt,[ee("div",Dt,[m(l,{separator:">"},{default:V(()=>[m(w,{to:{path:"/"}},{default:V(()=>[ae("首页")]),_:1}),m(w,{to:{path:`/category/${c.value.parentId}`}},{default:V(()=>[ae(te(c.value.parentName),1)]),_:1},8,["to"]),m(w,null,{default:V(()=>[ae(te(c.value.name),1)]),_:1})]),_:1})]),ee("div",Vt,[m(C,{modelValue:v.value.sortField,"onUpdate:modelValue":i[0]||(i[0]=T=>v.value.sortField=T),class:"demo-tabs",type:"card",onTabChange:r},{default:V(()=>[(k(!0),I(me,null,_e(a.value,(T,D)=>(k(),ge(g,{key:D,label:T.label,name:T.name},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),ee("div",Mt,te(v.value.sortField)+" 切換參數重新拿api數據 ",1),Se((k(),I("div",{class:"body","infinite-scroll-disabled":f.value},[(k(!0),I(me,null,_e(n.value,T=>(k(),ge(it,{key:T.id,goods:T},null,8,["goods"]))),128))],8,Ht)),[[N,y]]),s.value?(k(),I("div",Kt,"數據加載中 .....")):Ce("",!0)])])}}}),ea=ot(jt,[["__scopeId","data-v-feed8884"]]);export{ea as default};
