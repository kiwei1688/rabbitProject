import{j as Ne,k as Le,b as j,l as re,m as Se,a as q,u as we,_ as Ee,n as Ve,o as De,E as H,d as Me,e as He,p as Ue,q as U,r as Ke,f as fe,i as je,s as ve,w as qe,g as Ge}from"./base-XtxMCGkJ.js";import{E as We,a as Ye}from"./breadcrumb-item-CkrmKsSk.js";import{a as Je,b as pe}from"./category-DC43QHzy.js";import{R as Qe,g as L,O as ie,j as h,C as I,S as M,o as k,c as z,n as Ce,f as F,N as Xe,J as G,k as K,m as ce,U as Ze,b as m,G as et,v as oe,H as tt,B as at,P as st,Q as nt,y as Pe,L as ot,M as $e,V as lt,_ as rt,z as it,a as ee,w as D,t as te,F as me,d as _e,e as ae,q as ge}from"./index-gbW5PtlU.js";import{u as ct,t as he,G as ut}from"./GoodsItem-B_VmN9tY.js";import{t as W,U as xe}from"./event-DFKb8xsO.js";const ye=e=>{let t=0,a=e;for(;a;)t+=a.offsetTop,a=a.offsetParent;return t},dt=(e,t)=>Math.abs(ye(e)-ye(t)),A=e=>Qe(e),bt=(e,t)=>{if(!Ne)return!1;const a={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(t)],c=Le(e,a);return["scroll","auto","overlay"].some(n=>c.includes(n))},ft=(e,t)=>{if(!Ne)return;let a=e;for(;a;){if([window,document,document.documentElement].includes(a))return window;if(bt(a,t))return a;a=a.parentNode}return a},Y=Symbol("tabsRootContextKey"),vt=j({tabs:{type:re(Array),default:()=>Se([])}}),Be="ElTabBar",pt=L({name:Be}),mt=L({...pt,props:vt,setup(e,{expose:t}){const a=e,c=G(),n=ie(Y);n||W(Be,"<el-tabs><el-tab-bar /></el-tabs>");const s=q("tabs"),f=h(),v=h(),u=()=>{let r=0,y=0;const o=["top","bottom"].includes(n.props.tabPosition)?"width":"height",i=o==="width"?"x":"y",S=i==="x"?"left":"top";return a.tabs.every(l=>{var g,C;const w=(C=(g=c.parent)==null?void 0:g.refs)==null?void 0:C[`tab-${l.uid}`];if(!w)return!1;if(!l.active)return!0;r=w[`offset${A(S)}`],y=w[`client${A(o)}`];const T=window.getComputedStyle(w);return o==="width"&&(a.tabs.length>1&&(y-=Number.parseFloat(T.paddingLeft)+Number.parseFloat(T.paddingRight)),r+=Number.parseFloat(T.paddingLeft)),!1}),{[o]:`${y}px`,transform:`translate${A(i)}(${r}px)`}},b=()=>v.value=u();return I(()=>a.tabs,async()=>{await M(),b()},{immediate:!0}),we(f,()=>b()),t({ref:f,update:b}),(r,y)=>(k(),z("div",{ref_key:"barRef",ref:f,class:Ce([F(s).e("active-bar"),F(s).is(F(n).props.tabPosition)]),style:Xe(v.value)},null,6))}});var _t=Ee(mt,[["__file","tab-bar.vue"]]);const gt=j({panes:{type:re(Array),default:()=>Se([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),ht={tabClick:(e,t,a)=>a instanceof Event,tabRemove:(e,t)=>t instanceof Event},Te="ElTabNav",yt=L({name:Te,props:gt,emits:ht,setup(e,{expose:t,emit:a}){const c=G(),n=ie(Y);n||W(Te,"<el-tabs><tab-nav /></el-tabs>");const s=q("tabs"),f=Ve(),v=De(),u=h(),b=h(),r=h(),y=h(),o=h(!1),i=h(0),S=h(!1),l=h(!0),g=K(()=>["top","bottom"].includes(n.props.tabPosition)?"width":"height"),C=K(()=>({transform:`translate${g.value==="width"?"X":"Y"}(-${i.value}px)`})),w=()=>{if(!u.value)return;const p=u.value[`offset${A(g.value)}`],_=i.value;if(!_)return;const d=_>p?_-p:0;i.value=d},T=()=>{if(!u.value||!b.value)return;const p=b.value[`offset${A(g.value)}`],_=u.value[`offset${A(g.value)}`],d=i.value;if(p-d<=_)return;const P=p-d>_*2?d+_:p-_;i.value=P},V=async()=>{const p=b.value;if(!o.value||!r.value||!u.value||!p)return;await M();const _=r.value.querySelector(".is-active");if(!_)return;const d=u.value,P=["top","bottom"].includes(n.props.tabPosition),$=_.getBoundingClientRect(),E=d.getBoundingClientRect(),O=P?p.offsetWidth-E.width:p.offsetHeight-E.height,x=i.value;let N=x;P?($.left<E.left&&(N=x-(E.left-$.left)),$.right>E.right&&(N=x+$.right-E.right)):($.top<E.top&&(N=x-(E.top-$.top)),$.bottom>E.bottom&&(N=x+($.bottom-E.bottom))),N=Math.max(N,0),i.value=Math.min(N,O)},de=()=>{var p;if(!b.value||!u.value)return;e.stretch&&((p=y.value)==null||p.update());const _=b.value[`offset${A(g.value)}`],d=u.value[`offset${A(g.value)}`],P=i.value;d<_?(o.value=o.value||{},o.value.prev=P,o.value.next=P+d<_,_-P<d&&(i.value=_-d)):(o.value=!1,P>0&&(i.value=0))},Ae=p=>{const _=p.code,{up:d,down:P,left:$,right:E}=U;if(![d,P,$,E].includes(_))return;const O=Array.from(p.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)")),x=O.indexOf(p.target);let N;_===$||_===d?x===0?N=O.length-1:N=x-1:x<O.length-1?N=x+1:N=0,O[N].focus({preventScroll:!0}),O[N].click(),be()},be=()=>{l.value&&(S.value=!0)},J=()=>S.value=!1;return I(f,p=>{p==="hidden"?l.value=!1:p==="visible"&&setTimeout(()=>l.value=!0,50)}),I(v,p=>{p?setTimeout(()=>l.value=!0,50):l.value=!1}),we(r,de),ce(()=>setTimeout(()=>V(),0)),Ze(()=>de()),t({scrollToActiveTab:V,removeFocus:J}),I(()=>e.panes,()=>c.update(),{flush:"post",deep:!0}),()=>{const p=o.value?[m("span",{class:[s.e("nav-prev"),s.is("disabled",!o.value.prev)],onClick:w},[m(H,null,{default:()=>[m(Me,null,null)]})]),m("span",{class:[s.e("nav-next"),s.is("disabled",!o.value.next)],onClick:T},[m(H,null,{default:()=>[m(He,null,null)]})])]:null,_=e.panes.map((d,P)=>{var $,E,O,x;const N=d.uid,Q=d.props.disabled,X=(E=($=d.props.name)!=null?$:d.index)!=null?E:`${P}`,Z=!Q&&(d.isClosable||e.editable);d.index=`${P}`;const Re=Z?m(H,{class:"is-icon-close",onClick:R=>a("tabRemove",d,R)},{default:()=>[m(Ue,null,null)]}):null,ze=((x=(O=d.slots).label)==null?void 0:x.call(O))||d.props.label,Ie=!Q&&d.active?0:-1;return m("div",{ref:`tab-${N}`,class:[s.e("item"),s.is(n.props.tabPosition),s.is("active",d.active),s.is("disabled",Q),s.is("closable",Z),s.is("focus",S.value)],id:`tab-${X}`,key:`tab-${N}`,"aria-controls":`pane-${X}`,role:"tab","aria-selected":d.active,tabindex:Ie,onFocus:()=>be(),onBlur:()=>J(),onClick:R=>{J(),a("tabClick",d,X,R)},onKeydown:R=>{Z&&(R.code===U.delete||R.code===U.backspace)&&a("tabRemove",d,R)}},[ze,Re])});return m("div",{ref:r,class:[s.e("nav-wrap"),s.is("scrollable",!!o.value),s.is(n.props.tabPosition)]},[p,m("div",{class:s.e("nav-scroll"),ref:u},[m("div",{class:[s.e("nav"),s.is(n.props.tabPosition),s.is("stretch",e.stretch&&["top","bottom"].includes(n.props.tabPosition))],ref:b,style:C.value,role:"tablist",onKeydown:Ae},[e.type?null:m(_t,{ref:y,tabs:[...e.panes]},null),_])])])}}}),Tt=j({type:{type:String,values:["card","border-card",""],default:""},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:re(Function),default:()=>!0},stretch:Boolean}),se=e=>tt(e)||je(e),Nt={[xe]:e=>se(e),tabClick:(e,t)=>t instanceof Event,tabChange:e=>se(e),edit:(e,t)=>["remove","add"].includes(t),tabRemove:e=>se(e),tabAdd:()=>!0},St=L({name:"ElTabs",props:Tt,emits:Nt,setup(e,{emit:t,slots:a,expose:c}){var n;const s=q("tabs"),{children:f,addChild:v,removeChild:u}=ct(G(),"ElTabPane"),b=h(),r=h((n=e.modelValue)!=null?n:"0"),y=async(l,g=!1)=>{var C,w,T;if(!(r.value===l||fe(l)))try{await((C=e.beforeLeave)==null?void 0:C.call(e,l,r.value))!==!1&&(r.value=l,g&&(t(xe,l),t("tabChange",l)),(T=(w=b.value)==null?void 0:w.removeFocus)==null||T.call(w))}catch{}},o=(l,g,C)=>{l.props.disabled||(y(g,!0),t("tabClick",l,C))},i=(l,g)=>{l.props.disabled||fe(l.props.name)||(g.stopPropagation(),t("edit",l.props.name,"remove"),t("tabRemove",l.props.name))},S=()=>{t("edit",void 0,"add"),t("tabAdd")};return I(()=>e.modelValue,l=>y(l)),I(r,async()=>{var l;await M(),(l=b.value)==null||l.scrollToActiveTab()}),et(Y,{props:e,currentName:r,registerPane:v,unregisterPane:u}),c({currentName:r}),()=>{const l=a["add-icon"],g=e.editable||e.addable?m("span",{class:s.e("new-tab"),tabindex:"0",onClick:S,onKeydown:T=>{T.code===U.enter&&S()}},[l?oe(a,"add-icon"):m(H,{class:s.is("icon-plus")},{default:()=>[m(Ke,null,null)]})]):null,C=m("div",{class:[s.e("header"),s.is(e.tabPosition)]},[g,m(yt,{ref:b,currentName:r.value,editable:e.editable,type:e.type,panes:f.value,stretch:e.stretch,onTabClick:o,onTabRemove:i},null)]),w=m("div",{class:s.e("content")},[oe(a,"default")]);return m("div",{class:[s.b(),s.m(e.tabPosition),{[s.m("card")]:e.type==="card",[s.m("border-card")]:e.type==="border-card"}]},[...e.tabPosition!=="bottom"?[C,w]:[w,C]])}}}),wt=j({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),Et=["id","aria-hidden","aria-labelledby"],Oe="ElTabPane",Ct=L({name:Oe}),Pt=L({...Ct,props:wt,setup(e){const t=e,a=G(),c=at(),n=ie(Y);n||W(Oe,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const s=q("tab-pane"),f=h(),v=K(()=>t.closable||n.props.closable),u=ve(()=>{var i;return n.currentName.value===((i=t.name)!=null?i:f.value)}),b=h(u.value),r=K(()=>{var i;return(i=t.name)!=null?i:f.value}),y=ve(()=>!t.lazy||b.value||u.value);I(u,i=>{i&&(b.value=!0)});const o=st({uid:a.uid,slots:c,props:t,paneName:r,active:u,index:f,isClosable:v});return ce(()=>{n.registerPane(o)}),nt(()=>{n.unregisterPane(o.uid)}),(i,S)=>F(y)?Pe((k(),z("div",{key:0,id:`pane-${F(r)}`,class:Ce(F(s).b()),role:"tabpanel","aria-hidden":!F(u),"aria-labelledby":`tab-${F(r)}`},[oe(i.$slots,"default")],10,Et)),[[ot,F(u)]]):$e("v-if",!0)}});var ke=Ee(Pt,[["__file","tab-pane.vue"]]);const $t=qe(St,{TabPane:ke}),xt=Ge(ke),B="ElInfiniteScroll",Bt=50,Ot=200,kt=0,Ft={delay:{type:Number,default:Ot},distance:{type:Number,default:kt},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},ue=(e,t)=>Object.entries(Ft).reduce((a,[c,n])=>{var s,f;const{type:v,default:u}=n,b=e.getAttribute(`infinite-scroll-${c}`);let r=(f=(s=t[b])!=null?s:b)!=null?f:u;return r=r==="false"?!1:r,r=v(r),a[c]=Number.isNaN(r)?u:r,a},{}),Fe=e=>{const{observer:t}=e[B];t&&(t.disconnect(),delete e[B].observer)},At=(e,t)=>{const{container:a,containerEl:c,instance:n,observer:s,lastScrollTop:f}=e[B],{disabled:v,distance:u}=ue(e,n),{clientHeight:b,scrollHeight:r,scrollTop:y}=c,o=y-f;if(e[B].lastScrollTop=y,s||v||o<0)return;let i=!1;if(a===e)i=r-(b+y)<=u;else{const{clientTop:S,scrollHeight:l}=e,g=dt(e,c);i=y+b>=g+S+l-u}i&&t.call(n)};function ne(e,t){const{containerEl:a,instance:c}=e[B],{disabled:n}=ue(e,c);n||a.clientHeight===0||(a.scrollHeight<=a.clientHeight?t.call(c):Fe(e))}const Rt={async mounted(e,t){const{instance:a,value:c}=t;lt(c)||W(B,"'v-infinite-scroll' binding value must be a function"),await M();const{delay:n,immediate:s}=ue(e,a),f=ft(e,!0),v=f===window?document.documentElement:f,u=he(At.bind(null,e,c),n);if(f){if(e[B]={instance:a,container:f,containerEl:v,delay:n,cb:c,onScroll:u,lastScrollTop:v.scrollTop},s){const b=new MutationObserver(he(ne.bind(null,e,c),Bt));e[B].observer=b,b.observe(e,{childList:!0,subtree:!0}),ne(e,c)}f.addEventListener("scroll",u)}},unmounted(e){if(!e[B])return;const{container:t,onScroll:a}=e[B];t==null||t.removeEventListener("scroll",a),Fe(e)},async updated(e){if(!e[B])await M();else{const{containerEl:t,cb:a,observer:c}=e[B];t.clientHeight&&c&&ne(e,a)}}},le=Rt;le.install=e=>{e.directive("InfiniteScroll",le)};const zt=le,It={class:"container"},Lt={class:"bread-container"},Vt={class:"sub-container"},Dt={style:{"padding-left":"35px",color:"#999","font-size":"12px"}},Mt=["infinite-scroll-disabled"],Ht={key:0,class:"loading"},Ut=L({name:"subCategory"}),Kt=Object.assign(Ut,{setup(e){const t=it(),a=h([{label:"最新商品",name:"publishTime"},{label:"最高人氣",name:"orderNum"},{label:"最多評論",name:"evaluateNum"}]),c=h([]),n=h([]),s=h(!1),f=h(!1),v=h({categoryId:t.params.id,page:1,pageSize:20,sortField:"publishTime"}),u=async()=>{try{await Je(t.params.id).then(o=>{o.msg==="操作成功"&&(c.value=o.result)})}catch(o){console.log("err ======",o)}},b=async()=>{const o=await pe(v.value);n.value=o.result.items},r=()=>{console.log("tabs切換了 =======",v.value),v.value.page=1,b()},y=async()=>{v.value.page++,s.value=!0;const o=await pe(v.value);o&&(n.value=[...n.value,...o.result.items]),console.log("page ~~~",v.value.page),o.result.items.length||(s.value=!1,f.value=!0)};return ce(()=>{u(),b()}),(o,i)=>{const S=Ye,l=We,g=xt,C=$t,w=zt;return k(),z("div",It,[ee("div",Lt,[m(l,{separator:">"},{default:D(()=>[m(S,{to:{path:"/"}},{default:D(()=>[ae("首页")]),_:1}),m(S,{to:{path:`/category/${c.value.parentId}`}},{default:D(()=>[ae(te(c.value.parentName),1)]),_:1},8,["to"]),m(S,null,{default:D(()=>[ae(te(c.value.name),1)]),_:1})]),_:1})]),ee("div",Vt,[m(C,{modelValue:v.value.sortField,"onUpdate:modelValue":i[0]||(i[0]=T=>v.value.sortField=T),class:"demo-tabs",type:"card",onTabChange:r},{default:D(()=>[(k(!0),z(me,null,_e(a.value,(T,V)=>(k(),ge(g,{key:V,label:T.label,name:T.name},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),ee("div",Dt,te(v.value.sortField)+" 切換參數重新拿api數據 ",1),Pe((k(),z("div",{class:"body","infinite-scroll-disabled":f.value},[(k(!0),z(me,null,_e(n.value,T=>(k(),ge(ut,{key:T.id,goods:T},null,8,["goods"]))),128))],8,Mt)),[[w,y]]),s.value?(k(),z("div",Ht,"數據加載中 .....")):$e("",!0)])])}}}),Qt=rt(Kt,[["__scopeId","data-v-feed8884"]]);export{Qt as default};
